(this["webpackJsonptweet-react"]=this["webpackJsonptweet-react"]||[]).push([[0],{12:function(e,t,n){},13:function(e,t,n){},14:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(5),s=n.n(c),o=(n(12),n(4)),l=n(1),i=function(e,t,n,a){var r=new XMLHttpRequest,c=u("csrftoken");r.open("POST","http://127.0.0.1:8000/tweet/action/"),r.setRequestHeader("Content-Type","application/json"),c&&(r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("X-CSRFToken",c));var s=JSON.stringify({id:e,action:a,content:n});r.onload=function(){console.log(r.status),t(r.response,r.status)},r.onerror=function(e){alert("there was an error2")},r.send(s)},u=function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),a=0;a<n.length;a++){var r=n[a].trim();if(r.substring(0,e.length+1)===e+"="){t=decodeURIComponent(r.substring(e.length+1));break}}return t},m=function(e){var t=e.username,n=Object(a.useState)([]),c=Object(l.a)(n,2),s=c[0],i=c[1],u=Object(a.useState)([]),m=Object(l.a)(u,2),w=m[0],f=m[1];return Object(a.useEffect)((function(){var t=Object(o.a)(e.newTweets).concat(s);t.length!==w.length&&f(t)}),[e.newTweets,s,w]),Object(a.useEffect)((function(){!function(e,t){var n;n=t?"http://127.0.0.1:8000/tweets/?username=".concat(t):"http://127.0.0.1:8000/tweets/",fetch(n).then((function(e){return e.json()})).then((function(t){e(t)})).catch((function(e){return alert("there was an error")}))}(i,t)}),[t]),r.a.createElement("div",{className:"App"},w.map((function(t){return r.a.createElement(b,{tweet:t,setTweets:e.reTweetCallback,className:"rounded m-3 col-10 border bg-dark",key:t.id})})))},w=function(e){var t=e.tweet,n=Object(a.useState)(t.likes?t.likes:0),c=Object(l.a)(n,2),s=c[0],o=c[1],u=function(e,t){200===t?o(JSON.parse(e).likes):alert("Error in like")};return r.a.createElement(a.Fragment,null,r.a.createElement("div",{className:"text-danger m-3"},r.a.createElement("p",null,"Likes : ",s)),r.a.createElement("button",{className:"btn btn-success ml-2",onClick:function(){return i(t.id,u,t.content,"like")}},"Like"),r.a.createElement("button",{className:"btn btn-danger ml-2",onClick:function(){return i(t.id,u,t.content,"unlike")}},"Un Like"),r.a.createElement("button",{className:"btn btn-primary ml-2",onClick:function(e){console.log("HI"),window.location.href="/".concat(t.id)}},"View"))},f=function(e){var t=e.tweet,n=e.setTweets;return r.a.createElement("button",{className:"btn btn-info m-2",onClick:function(){return i(t.id,n,t.content,"retweet")}},"Re Tweet")},d=function(e){var t=e.tweet,n=e.setTweets;return r.a.createElement(a.Fragment,null,t.parent&&r.a.createElement("h3",{className:"text-success mt-3"},"Retweet of :"),r.a.createElement("div",null,r.a.createElement("p",null,t.parent&&r.a.createElement(b,{tweet:t.parent,setTweets:n,className:"rounded m-3 col-10 border bg-warning"}))))},b=function(e){var t=e.tweet,n=e.setTweets,c=e.className;return r.a.createElement("div",{style:{display:"inline-block"},className:c,id:"tweet-"+t.id},r.a.createElement("h3",{className:"text-success"},"Tweet ",t.id),r.a.createElement(d,{tweet:t,setTweets:n}),r.a.createElement("div",{className:"text-info m-3"},r.a.createElement("p",null,t.content?t.content:"NO CONTENT")),"rounded m-3 col-10 border bg-warning"===c?r.a.createElement("button",{className:"btn btn-primary ml-2",onClick:function(e){console.log("HI"),window.location.href="/".concat(t.id)}},"View"):null,"rounded m-3 col-10 border bg-warning"===c?null:r.a.createElement(a.Fragment,null,r.a.createElement(w,{tweet:t}),r.a.createElement(f,{tweet:t,setTweets:n})))},p=function(e){var t=e.username,n="false"!==e.canTweet,c=r.a.createRef(),s=Object(a.useState)([]),i=Object(l.a)(s,2),w=i[0],f=i[1];return r.a.createElement("div",{className:"text-center"},n&&r.a.createElement("div",{className:"m-3"},r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var t=c.current.value;if(""===t.trim())alert("Tweet can't be empty");else{var n=Object(o.a)(w);!function(e,t){var n=new XMLHttpRequest,a=u("csrftoken");n.open("POST","http://127.0.0.1:8000/create-tweet"),n.setRequestHeader("Content-Type","application/json"),a&&(n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.setRequestHeader("X-CSRFToken",a));var r=JSON.stringify({content:e});n.onload=function(){t(n.response,n.status)},n.onerror=function(e){alert("there was an error in create tweet")},n.send(r)}(t,(function(e,t){201===t?(n.unshift(JSON.parse(e)),f(n)):alert("error in create")}))}c.current.value=""},className:"col-6 offset-3"},r.a.createElement("div",{className:"justify-content-center"},r.a.createElement("textarea",{ref:c,className:"form-control",name:"tweet"}),r.a.createElement("button",{type:"submit",className:"btn btn-primary my-3"},"Tweet")))),r.a.createElement(m,{newTweets:w,reTweetCallback:function(e,t){var n=Object(o.a)(w);201===t?(n.unshift(JSON.parse(e)),f(n)):alert("error in retweet")},username:t}))},E=function(e){var t=e.tweetId,n=Object(a.useState)(!1),c=Object(l.a)(n,2),s=c[0],o=c[1],i=Object(a.useState)(null),u=Object(l.a)(i,2),m=u[0],w=u[1];return Object(a.useEffect)((function(){!1===s&&(!function(e,t){var n=new XMLHttpRequest;n.open("GET","http://127.0.0.1:8000/tweet/".concat(e)),n.setRequestHeader("Content-Type","application/json"),n.onload=function(){t(n.response,n.status)},n.onerror=function(e){alert("there was an error")},n.send()}(t,(function(e,t){200===t?w(JSON.parse(e)):alert("error")})),o(!0))}),[s,o]),null===m?null:r.a.createElement(b,{tweet:m,className:e.className,setTweets:e.setTweets})};n(13);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var h=document.getElementById("root");s.a.render(r.a.createElement(p,{username:h.dataset.username,canTweet:h.dataset.canTweet}),h),document.querySelectorAll(".tweet-detail").forEach((function(e){s.a.render(r.a.createElement(E,{tweetId:e.dataset.tweetId,className:e.dataset.className}),e)})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},7:function(e,t,n){e.exports=n(14)}},[[7,1,2]]]);console.log("IIN MAiN")
//# sourceMappingURL=main.c9889d4b.chunk.js.map