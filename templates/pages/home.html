{% extends 'base.html' %}

{% block content %}
    <h1 class="text-center m-2">Welcome to tweet</h1>

    

    <div class='row m-5'>
        <div class='col-md-4 mx-auto col-10'>
            <form class='form' method="POST" action='/create-tweet'>
                {% csrf_token %}
                <input type='hidden' value="/" name='next'>
                <textarea class="form-control" name='content' placeholder="Tweet"></textarea>
                <button class="btn btn-primary" type='submit'>Submit</button>
            </form>
        </div>
    </div>

    <div id='tweets' class="text-center row">

    </div>

<script>
    const handleDidLike = (id , currCount) => {
    }
    const likeBtn = (tweet) => `<button class="btn btn-info mb-2" onclick='handleDidLike(${tweet.id} , ${tweet.likes})'>Like</button>`
    const formatTweet = tweet => `<div style="display: inline-block;" class='rounded m-3 col-12 col-md-3 border bg-dark' id='tweet-${tweet.id}'><h3 class='text-danger'>Tweet ${tweet.id}</h3><p class='text-info m-3'>${tweet.content}<p class='text-success m-3'>likes : ${tweet.likes}<p></p>${likeBtn(tweet)}</div>`
    const tweetElement = document.getElementById('tweets');
    tweetElement.innerHTML = "loading..."
    fetch('/tweets').then(response => response.json()).then(r => {
        tweetElement.innerHTML = "";
        r.response.map(tweet => tweetElement.innerHTML += formatTweet(tweet))
    });
</script>
{% endblock content %}